--2
ALTER TABLE EXAM_STUDENT
ADD CONSTRAINT EXAM_STUDENT_PK PRIMARY KEY (STUDENT_ID);

ALTER TABLE EXAM_TEACHER
ADD CONSTRAINT EXAM_TEACHER_PK PRIMARY KEY (TEACHER_ID);

ALTER TABLE EXAM_MODULE
ADD CONSTRAINT EXAM_MODULE_PK PRIMARY KEY (MODULE_CODE);

ALTER TABLE EXAM_ATTENDS
ADD CONSTRAINT EXAM_ATTENDS_PK PRIMARY KEY (MARKS);

ALTER TABLE EXAM_TEACHES
ADD CONSTRAINT EXAM_TEACHES_PK PRIMARY KEY (CONTRIBUTION);

ALTER TABLE EXAM_TUTORS
ADD CONSTRAINT EXAM_TUTORS_PK PRIMARY KEY (NO_MEETINGS);

--3
ALTER TABLE EXAM_ATTENDS
ADD CONSTRAINT EXAM_ATTENDS_FK_1 FOREIGN KEY (MODULE_CODE) REFERENCES EXAM_MODULE(MODULE_CODE);
ADD CONSTRAINT EXAM_ATTENDS_FK_2 FOREIGN KEY (STUDENT_ID) REFERENCES EXAM_STUDENT(STUDENT_ID);

ALTER TABLE EXAM_TEACHES
ADD CONSTRAINT EXAM_TEACHES_FK_1 FOREIGN KEY (MODULE_CODE) REFERENCES EXAM_MODULE(MODULE_CODE);
ADD CONSTRAINT EXAM_TEACHES_FK_2 FOREIGN KEY (TEACHER_ID) REFERENCES EXAM_TEACHER(TEACHER_ID);

ALTER TABLE EXAM_TUTORS
ADD CONSTRAINT EXAM_TUTORS_FK_1 FOREIGN KEY (STUDENT_ID) REFERENCES EXAM_STUDENT(STUDENT_ID);
ADD CONSTRAINT EXAM_TUTORS_FK_2 FOREIGN KEY (TEACHER_ID) REFERENCES EXAM_TEACHER(TEACHER_ID);

--4
DESCRIBE EXAM_STUDENT;
DESCRIBE EXAM_TEACHER;

CREATE TABLE EXAM_TUTORS
(
NO_MEETINGS NUMBER(4) GENERATED BY DEFAULT ON NULL AS IDENTITY,
CONSTRAINT EXAM_TUTORS_PK PRIMARY KEY (NO_MEETINGS)
CONSTRAINT EXAM_TUTORS_FK_1 FOREIGN KEY (STUDENT_ID) REFERENCES EXAM_STUDENT(STUDENT_ID)
CONSTRAINT EXAM_TUTORS_FK_2 FOREIGN KEY (TEACHER_ID) REFERENCES EXAM_TEACHER(TEACHER_ID)
);

DESCRIBE EXAM_TUTORS
--5
INSERT INTO EXAM_TUTORS(,,,)
SELECT A.PAINTING_ID, B.GALLERY_ID,'01/23/2018','12/20/2018' FROM TEST_PAINTING A,TEST_GALlERY B WHERE A.PAINTING_NAME LIKE 'Guernica' and B.GALLERY_NAME LIKE 'Tate Modern';
INSERT INTO EXAM_TUTORS(PAINTING,BORROWING_GALLERY,FROM_DATE,TO_DATE)
SELECT A.PAINTING_ID, B.GALLERY_ID,'05/22/2018','12/21/2018' FROM TEST_PAINTING A,TEST_GALlERY B WHERE A.PAINTING_NAME LIKE 'The Starry Night' and B.GALLERY_NAME LIKE 'Tate Modern';

INSERT INTO EXAM_TUTORS(,,,)
VALUES(,,,);

--6 
CREATE VIEW VU_EXAM_6A AS

CREATE VIEW PN_view AS
SELECT PAINTING_NAME
FROM TEST_PAINTING, TEST_GALLERY
WHERE TEST_GALLERY.GALLERY_ID = TEST_PAINTING.GALLERY_ID
AND UPPER(city) like 'LONDON'
ORDER BY PAINTING_NAME;

SELECT * FROM PN_view;

---b)
CREATE VIEW TPE_view AS
SELECT GALLERY_NAME
FROM TEST_PAINTING, TEST_GALLERY
WHERE TEST_GALLERY.GALLERY_ID = TEST_PAINTING.GALLERY_ID
AND UPPER(painting_name) like 'THE PATATO EATERS';

SELECT * FROM TPE_view;

--c)
Claude Monet
CREATE VIEW CM_view AS
SELECT GALLERY_NAME
FROM TEST_ARTIST, TEST_GALLERY, TEST_PAINTING
WHERE TEST_GALLERY.GALLERY_ID = TEST_PAINTING.GALLERY_ID
AND TEST_ARTIST.ARTIST_ID = TEST_PAINTING.ARTIST_ID
AND FIRST_NAME||LAST_NAME = 'ClaudeMonet';

SELECT * FROM CM_view;

create view VU_TEST_GALLERIES_CLAUDE_MONET as
select gallery_name
from test_gallery, test_painting,test_artist
where test_gallery.gallery_id=test_painting.gallery_id
and test_painting.artist_id=test_artist.artist_id
and upper(test_painting .first_name) like 'CLAUDE'
and upper(test_painting .last_name) like 'MONET';

---d)
CREATE VIEW CN_view AS
SELECT CITY
FROM TEST_GALLERY
GROUP BY city
HAVING COUNT(GALLERY_ID)>1;

SELECT * FROM CN_view;

---e) ****
create view VU_TEST_THE_GALLERIES as
select SUM(count(TEST_PAINTING.PAINTING_ID)) "Count"
from TEST_GALLERY, TEST_PAINTING
where TEST_GALLERY.GALLERY_ID=TEST_PAINTING.GALLERY_ID
group by TEST_GALLERY.GALLERY_NAME
having GALLERY_NAME like 'The%';

select * from VU_TEST_THE_GALLERIES ;

---f) ****
Guernica
CREATE VIEW PAINTER_view_3 AS
SELECT TEST_ARTIST.FIRST_NAME, TEST_ARTIST.LAST_NAME
FROM TEST_ARTIST,TEST_PAINTING
WHERE TEST_ARTIST.ARTIST_ID = TEST_PAINTING.ARTIST_ID
AND TEST_PAINTING.gallery_id in (select test_gallery.gallery_id
                    from test_gallery,test_painting
                    where test_gallery.gallery_id=test_painting.gallery_id
                    and upper(test_painting.painting_name) like 'GUERNICA');
SELECT * FROM PAINTER_view_3;

--g)
CREATE VIEW C_view_4 AS
SELECT sum(count(PAINTING_NAME)) AS Total
FROM TEST_PAINTING
GROUP BY PAINTING_NAME
HAVING length(PAINTING_NAME)=17;
select * from C_view_4;

---h
CREATE VIEW longestt_view AS 
SELECT PAINTING_NAME AS l
FROM (select * from TEST_PAINTING order by length(PAINTING_NAME) desc)
WHERE rownum=1;
select * from longestt_view;

CREATE VIEW longesttt_view AS 
SELECT PAINTING_NAME AS l
FROM TEST_PAINTING 
order by length(PAINTING_NAME) desc
fetch first 1rows only;
select * from longesttt_view;

----i)
CREATE VIEW VU_TEST_CITY_NICE_FORMAT AS
SELECT 'The city of '|| city ||' has '|| count(GALLERY_ID) || ' galleries.' AS "Number of Galleries"
FROM TEST_GALLERY G
group by G.city
having count(GALLERY_ID)>1;
select * from VU_TEST_CITY_NICE_FORMAT_1 ;

----J)
SELECT 'The nationality of '|| FIRST_NAME|| ' ' || LAST_NAME || ' is '|| NATIONALITY AS "Painter's Nationality"
FROM TEST_ARTIST
where FIRST_NAME||' ' ||LAST_NAME = 'Pablo Picasso';
